<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Meta tags for character encoding and responsive viewport -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Favicon for browser tab -->
  <link rel="shortcut icon" href="/images/cj-spurr-icon-w.png" type="image/x-icon">
  
  <!-- Google Fonts import for Montserrat font family -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  
  <!-- CSS stylesheets -->
  <link rel="stylesheet" href="/css/main.css">              <!-- Main stylesheet -->
  <link rel="stylesheet" href="/css/imageCarousel.css">     <!-- Image carousel specific styles -->
  <link rel="stylesheet" href="/css/ourProjects.css">       <!-- Projects page specific styles -->
  
  <!-- JavaScript files (deferred to load after HTML parsing) -->
  <script defer src="/js/verticalNavBar.js"></script>      <!-- Mobile navigation functionality -->
  <script defer src="/js/autoImageCarousel.js"></script>   <!-- Auto-rotating image carousel -->
  <script defer src="/js/shrinkNavBar.js"></script>        <!-- Navbar shrinking on scroll -->
  
  <!-- Dynamic page title using EJS template - displays location name in uppercase -->
  <title>
    <%= location.name.toUpperCase() %> | C J SPURR BUILDERS LTD
  </title>
</head>

<body>
  <!-- Include navigation bar partial -->
  <%- include('partials/navbar') %>
  
  <!-- Hero section with main carousel -->
  <section>
    <!-- Full-width image carousel/slideshow container -->
    <div class="slideshow-container full-width">
      <!-- Licensed Building Practitioner logo overlay -->
      <img src="/images/LBPLogo.png" alt="licensed building practitioner logo" class="lbp-logo">
      
      <!-- Slide 1: Pukapuka Road project image -->
      <div class="mySlides fade">
        <img src="/images/Pukapuka-Road-6.jpg" alt="Pukapuka-Road-6" draggable="false">
      </div>

      <!-- Slide 2: Pukapuka Road project image -->
      <div class="mySlides fade">
        <img src="/images/Pukapuka-Road-2.jpg" alt="Pukapuka-Road-2" draggable="false">
      </div>

      <!-- Slide 3: Pukapuka Road project image -->
      <div class="mySlides fade">
        <img src="/images/Pukapuka-Road-7.jpg" alt="Pukapuka-Road-7" draggable="false">
      </div>

      <!-- Carousel navigation dots -->
      <div class="dot-container" style="margin-left: 15px;">
        <!-- Dot 1 with background and fill elements for animation -->
        <span class="dot">
          <span class="dot-bg"></span>
          <span class="dot-fill"></span>
        </span>
        <!-- Dot 2 with background and fill elements for animation -->
        <span class="dot">
          <span class="dot-bg"></span>
          <span class="dot-fill"></span>
        </span>
        <!-- Dot 3 with background and fill elements for animation -->
        <span class="dot">
          <span class="dot-bg"></span>
          <span class="dot-fill"></span>
        </span>
      </div>
    </div>

    <!-- Introduction section with grey background -->
    <div class="grey">
      <!-- Company logo -->
      <img src="/images/cj-spurr-icon-w.png" alt="C J SPURR BUILDERS LTD Logo" class="top logo" draggable="false">
      <br><br><br><br>
      
      <!-- Projects page introduction content -->
      <div style="display: contents;">
        <!-- Main page heading -->
        <h1>OUR PROJECTS</h1>
        <!-- Company experience statement (note: possible typo - "HOME" should likely be "HOMES") -->
        <h2 class="services-summary-1">"WE'VE BEEN BUILDING BEAUTIFUL HOME FOR OVER 25 YEARS."</h2>
        <br>
        <!-- Call-to-action button to contact page -->
        <a class="button grey-bg" href="/contact">CONTACT US</a>
        <br><br>
      </div>
    </div>
  </section>

  <!-- Main projects gallery section with light grey background -->
  <section style="background-color: #e1e1e1;">
    <br><br>
    <!-- Dynamic section heading showing location name -->
    <h1 style="text-align: center; color: #000; text-transform: uppercase;">
      <%= location.name %> Projects
    </h1>
    
    <!-- Projects gallery container -->
    <div class="project-gallery-container">
      <!-- Navigation button to return to main projects page -->
      <a class="button white-bg" href="/our-projects">GO BACK</a>
      
      <!-- Conditional rendering: Check if there are any projects for this location -->
      <% if (Object.keys(projects).length===0) { %>
        <!-- Message displayed when no projects are available -->
        <p style="text-align:center;">No projects available for this location yet.</p>
      <% } else { %>
        <!-- Loop through each project in the projects object -->
        <% for (let projectId in projects) { const project=projects[projectId]; %>
          <!-- Individual project card -->
          <div class="project-card">
            <!-- Project name as heading -->
            <h2 style="color: #000; text-transform: uppercase;">
              <%= project.name %>
            </h2>
            
            <!-- Photo grid for project images -->
            <div class="photo-grid">
              <!-- Loop through each photo in the project's photos array -->
              <% project.photos.forEach(photo=> { %>
                <!-- Clickable image that links to full-size photo -->
                <a href="<%= photo %>">
                  <img src="<%= photo %>" alt="<%= project.name %>" draggable="false">
                </a>
              <% }) %>
            </div>
          </div>
        <% } %>
      <% } %>
    </div>
  </section>

  <!-- Include footer partial -->
  <%- include('partials/footer') %>
</body>

</html>